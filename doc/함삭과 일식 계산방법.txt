 고영창   (fftkrr  )
합삭과 일식계산 방법..                       1998-11-29 15:58   131 line

제가 사용한 합삭시점계산과 일식 계산 방법은 이렇습니다.

일식 계산을 위해서는 합삭시점을 정확하게 구하고, 그 시점의 태양황경이
교점황경과 차이가 얼마나 나는지를 구해서 그 차이가 일식범위내면 일식이
있는것이고, 범위밖이면 일식이 없는것입니다.

일식을 계산하기 위해서는 우선 태양의 진황경을 구합니다.
진황경을 구하기 위해서 평균황경를 구하고, 그 평균황경과 근점이각을 구한후에
근점이각에 따른 중심차(공전궤도가 원일때(평균경도)와 타원일때(진황경)의 
위치차이)를 구합니다. 여기서 사용한 식은요.. 1996년 역서에 나온식입니다.

   평균황경 sl=278.956807+0.98564736*d
   근점이각 sm=356.087309+0.98560028*d
  
   (d는 1996년 1월 0일로 부터 떨어진 날수)

사실은 근지점경도를 먼저 구한후에 평균황경에서 근지점경도를 빼서 근점이각을
구하는데 설명상 근지점경도는 생략했습니다.(프로그램에서는 근점경도먼저 구했음)

이 평균황경과 근점이각을 이용해서 중심차를 구했는데, 이 중심차식은
케플러 제2법칙을 이용해서 타원상의 한점을 시간에 의한 매개변수표현법에 의해서
계산해서 구할수는 있지만 제가 게을러서 직접 계산하지 않고,
역법의 원리분석 288페이지에서 훔쳐왔습니다.

   중심차 sd=1.919*sin(sm)+0.020*sin(2*sm)
 
그러면 태양의 진황경은 

   진황경 sreal=sl+sd

가되구요..

이 진황경을 시간으로 분단위까지 구할수 있습니다.
(하루는 d에 1을 더하고, 한시간은 d에 0.04166666666, 1분은 d에 0.000694444을
더하면 특점 시점(분단위)까지 구할수 있습니다. 물론 균시차는 계산이 
안된상황이구요)


그다음에 달의 진황경을 구합니다.
달의 진황경 역시 달의 평균황경을 구한후에 중심차를 더해서 진황경을
구하는 방식을 사용했는데..
달은 태양-지구의 영향을 받기 때문에 약간 복잡하죠...

우선 달의 평균경도는 1996년을 기준으로

  평균황경 ml=27.836584+13.17639648*d

달 역시 타원궤도로 지구를 공전하기 때문에 근지점에 대한 근점이각을
구해서 달의 위치를 계산합니다. 또 참고삼아 교점황경도 구합니다.
이 식은 1996년 역서에서 가져왔구요..

  달의 근점 황경    mn=280.425774+0.11140356*d
  달의 평균근점이각 mm=ml-mn
  달의 교점황경 mi=202.489407-0.05295377*d

이렇게 구한후에 달의 근점이각과 태양의 근점이각, 교점황경을
이용해서 달의 중심차를 구합니다.
이 중심차는 3체운동(태양-지구-달)으로 구하는데 저는 어렴풋이 짐작만
할뿐이고, 실제로 구하는 유도과정은 정확히는 모릅니다. 물론 책보면
알수 있겠지만 게을러서 공부 안했씀..(죽어도 모른다는 말은 절대 못함 헤헤..)

달의 중심차는 다음처럼 복잡하게 표현됩니다. 역법의 원리분석에서 가져온
식입니다.

  중심차 md=5.068889*sin(mm)+0.146111*sin(2*mm)+0.01*sin(3*mm)
            -0.238056*sin(sm)-0.087778*sin(mm+sm)+0.048889*sin(mm-sm)
            -0.129722*sin(2*mi)-0.011111*sin(2*mi-mm)-0.012778*sin(2*mi+mm)

이제 이 중심차를 달의 평균황경에 더하면 달의 진황경이 나옵니다.

  달의 진황경 mreal=ml+md

이역시 태양진황경처럼 분단위까지 구하구요..

이제 특점 시점을 지정하면(d의 값을 지정하면) 해와 달의 위치(황경)를 구할수
있습니다.

음력날짜를 구하기 위해서는 초하루 날짜를 구해야 하는데 초하루는 합삭시간이
있는 날짜이고, 합삭시간은 달과 태양의 황경이 같은 시점입니다.

원래는 달과 태양의 황경이 같은 시점을 구하기 위해서는 우선 날짜를 주고 그 날의
0시의 달과 태양의 위치를 구한후에 이 달과 태양의 위치차이를 구하고,
그 날의 태양의 황경 변화율과 달의 황경변화율을 구한후 이 변화율의 차이를
구해서
위치차이를 변화율의 차이로 나누면 0시에서부터 합삭시점까지의 시간이 나옵니다.

그런데..이렇게 구하려면 간단한 미적분이 필요한데, 이렇게 쉬운문제가지고 미적분
하면 컴퓨터가 사람을 비웃습니다. 
그냥 루프를 돌려서 먼저 일단위,그다음 시간단위, 그다음 분단위로 루프를 돌리면
해당 시점을 미적분하지 않아도 정확하게(?) 알수 있습니다.

이렇게 해서 합삭시점을 분단위까지 구할수 있고, 그때의 태양황경(=달의 황경)을
구할수 있습니다.
그런데 이 시점은 진태양시에서 약간의 오차를 갖는데(약 10분내외), 이 진태양시가
평균태양시로 변환되면서 최대 40분내의 오차가 생깁니다.

이제 그날이 d의 값을 통해서 그레고리력으로 몇일이라는것을 알수 있죠.

그럼 그날이 음력 초하루가 되는거구요.

그날 일식이 있는지를 알기 위해서는 합삭시점의 태양황경과 저 위에서 구한 
교점황경의 차이를 구합니다.
 
   교점차=sreal-mi

를 한후에 이 교점차의 범위가 -18.5도에서 +18.5도 사이에 있으면 일식이 
있는것이고, 이범위를 벗어나면 일식이 없는거죠.
이 범위는 역법의 원리분석에 자세히 설명되어 있습니다.

1항성일이 100년에 0.001초씩 길어진다는것은 반영되지 않았습니다.
(사실 이 0.001초라는 수치가 맞는지 틀리는지 확인을 못했거든요)

사실은 역법의 원리분석에 보면 달과 태양경도식에 율리우스세기수와 관련된
항(曆表時관련항)이 있기는 하지만요.. 이 수치는 극히 작다고 생각하여 
무시했습니다. 하지만 이 역표시가 4000년에 약 2시간~6시간가량의 오차를
불러오는것 같습니다.

이상이 제가 사용한 일식계산 방법입니다.
24절기의 계산방법은 전혀 다릅니다.
이 다음글을 참고하세요.

 PRINTER/CAPTURE를 OFF 하시고  [ENTER] 를 누르십시오.
